{
  "type": "object",
  "properties": {
    "database": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string",
          "description": "The database host, without port or protocol"
        },
        "port": {
          "type": "number",
          "description": "The database port"
        },
        "database": {
          "type": "string",
          "description": "The database name"
        },
        "username": {
          "type": "string",
          "description": "The username that should be used to connect"
        },
        "password": {
          "type": "string",
          "description": "The password associated with the username provided"
        },
        "timeout": {
          "type": "array",
          "maxItems": 2,
          "items": {
            "type": "number"
          },
          "description": "The connection timeout as an array of [seconds, nanos]",
          "default": [3, 0]
        },
        "max_connections": {
          "type": "number",
          "exclusiveMinimum": 0,
          "description": "The maximum number of connections in the connection pool",
          "default": 5
        },
        "migrations": {
          "type": "string",
          "description": "Relative path (from the server process' working dir) where database migration scripts are found."
        }
      },
      "required": [
        "host",
        "port",
        "database",
        "username",
        "password",
        "migrations"
      ],
      "description": "Database pool properties",
      "additionalProperties": false
    },
    "server": {
      "type": "object",
      "description": "HTTP server settings",
      "properties": {
        "port": {
          "type": "number",
          "description": "The port the HTTP server should bind to",
          "default": 8080
        },
        "static_dir": {
          "type": "string",
          "description": "Relative path (from the server process' working dir) of static files to serve. This will serve index.html from the static_dir as a 404 fallback. If not provided, static files will not be served, and an empty 404 response will be returned instead."
        }
      },
      "required": [],
      "additionalProperties": false
    },
    "metrics": {
      "description": "Enable or disable the metrics feature",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "object",
              "description": "Enable metrics server and collection",
              "properties": {
                "port": {
                  "type": "number",
                  "description": "The port that the metrics server should bind to. Cannot be the same as the HTTP server.",
                  "default": 9100
                },
                "path": {
                  "type": "string",
                  "description": "The path that metrics should be served from on the provided port",
                  "default": "/metrics"
                }
              },
              "required": [],
              "additionalProperties": false
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "description": "Disable metrics server and collection",
          "properties": { "disabled": { "type": "object" } },
          "required": ["disabled"],
          "additionalProperties": false
        }
      ]
    },
    "openapi": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "object",
              "description": "Enable OpenAPI and SwaggerUI",
              "properties": {
                "swagger_path": {
                  "type": "string",
                  "description": "The path to serve SwaggerUI from.",
                  "default": "/swagger-ui"
                },
                "openapi_path": {
                  "type": "string",
                  "description": "The path to serve the OpenAPI definition from.",
                  "default": "/api-docs/openapi.json"
                }
              },
              "required": [],
              "additionalProperties": false
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "description": "Disable OpenAPI and SwaggerUI",
          "properties": { "disabled": { "type": "object" } },
          "required": ["disabled"],
          "additionalProperties": false
        }
      ]
    }
  },
  "additionalProperties": false,
  "required": ["database"]
}
